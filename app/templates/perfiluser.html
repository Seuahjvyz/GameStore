<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Mi Perfil</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/stylee.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
</head>

<body>
   <nav class="barra_lateral">
    <a class="logo_link" href="{{ url_for('root') }}"><img class="logo" src="{{ url_for('static', filename='img/Icon_GS.png') }}" alt="Logo"></a>

        <ul>
        <li><a class="enlace_barra_lateral" href="{{ url_for('root') }}"><i class="fa-solid fa-house"></i> Inicio</a></li>

        <li><a class="enlace_barra_lateral_fijo" href="{{ url_for('perfiluser') }}"><i class="fa-solid fa-circle-user"></i> Perfil</a></li>

        <li><a class="enlace_barra_lateral" href="{{ url_for('root') }}"><i class="fa-solid fa-magnifying-glass"></i> Buscar</a>
        </li>
        <li><a class="enlace_barra_lateral" href="{{ url_for('favoritos_page') }}"><i class="fa-solid fa-heart"></i> Favoritos</a></li>

        <li><a class="enlace_barra_lateral" href="{{ url_for('pedidos_page') }}"><i class="fa-solid fa-box"></i> Pedidos</a></li>
            <li>
                <h3>Categorías</h3>
            </li>
        <li><a class="enlace_barra_lateral" href="{{ url_for('category_page', slug='juegos') }}"><i class="fa-solid fa-ghost"></i> Juegos</a></li>
        <li><a class="enlace_barra_lateral" href="{{ url_for('category_page', slug='accesorios') }}"><i class="fa-solid fa-headset"></i> Accesorios</a></li>
        <li><a class="enlace_barra_lateral" href="{{ url_for('category_page', slug='consolas') }}"><i class="fa-solid fa-tv"></i> Consolas</a></li>
        <li><a class="enlace_barra_lateral" href="{{ url_for('category_page', slug='controles') }}"><i class="fa-solid fa-gamepad"></i> Controles</a></li>
        <li><a class="enlace_barra_lateral" href="{{ url_for('view_cart') }}"><i class="fa-solid fa-cart-shopping"></i> Carrito</a></li>
        <li><a class="enlace_barra_lateral" href="{{ url_for('registro') }}"><i class="fa-solid fa-users"></i> Registrarse</a></li>
        <li><a class="enlace_barra_lateral" href="{{ url_for('logout') }}"><i class="fa-solid fa-right-from-bracket"></i> Cerrar sesión</a></li>
        </ul>
    </nav>

    <main>
        <header class="encabezado">
            <section class="buscador">
                <input type="text" id="buscar-input" placeholder="Buscar producto">
                <button class="btn_buscar" id="buscar-btn"><i class="fa-solid fa-magnifying-glass"></i></button>
            </section>

            <section class="iconos">
                <button class="btn_notificaciones" id="mostrarNotificaciones"><i class="fa-solid fa-bell"></i></button>
                <a class="icon" href="{{ url_for('view_cart') }}"><i class="fa-solid fa-cart-shopping"></i></a>
                <a class="icon" href="{{ url_for('perfiluser') }}"><i class="fa-solid fa-circle-user"></i></a>
            </section>
        </header>


        <!-- Contenido del Perfil -->
        <div class="principal">
            <div class="perfil-contenedor">
                <h1 class="titulo-centrado">Mi Cuenta</h1>

                <div class="perfil-card">
                    <h2 class="nombre-usuario">{{ user.username }}</h2>
                    <p class="numero-cliente">Usuario ID: {{ user.id }}</p>

                    <div class="separador"></div>

                    <div class="datos-usuario">
                        <div class="dato-fila">
                            <span class="dato-label">Pedidos realizados:</span>
                            <span class="dato-valor">{{ orders|length }}</span>
                        </div>
                        <div class="dato-fila">
                            <span class="dato-label">Favoritos:</span>
                            <span class="dato-valor">{{ favorites_count }}</span>
                        </div>
                    </div>

                    <div class="separador"></div>

                    <div class="acciones-grid">
                        <a class="accion-item" href="{{ url_for('pedidos_page') }}">Historial de Compras</a>
                        <a class="accion-item" href="{{ url_for('favoritos_page') }}">Mis Favoritos</a>
                        <a class="accion-item" href="{{ url_for('view_cart') }}">Ver Carrito</a>
                    </div>
                </div>

                <div class="mis-pedidos">
                    <h3>Últimos pedidos</h3>
                    {% if orders and orders|length > 0 %}
                        <ul>
                        {% for o in orders %}
                            <li>Pedido #{{ o.id }} — Total: ${{ '%.2f'|format(o.total) }} — Estado: {{ o.status }} — {{ o.created_at.strftime('%Y-%m-%d') if o.created_at else '' }}</li>
                        {% endfor %}
                        </ul>
                    {% else %}
                        <p>No tienes pedidos todavía.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </main>

    <script src="{{ url_for('static', filename='js/site_actions.js') }}"></script>
</body>

</html>